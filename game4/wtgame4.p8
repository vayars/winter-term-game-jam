pico-8 cartridge // http://www.pico-8.com
version 33
__lua__
-- constants
speed = 0.25
friction = 0.90
gravity = 0.5
max_jumps = 1
jump_ht = 4
k_left = 0
k_right = 1
k_up = 2
k_down = 3
-- dynamic room variables
room = {x=0, y=0, id=0}
-- dynamic player state variables
x = 63
dx = 0
y = 87
dy = 0
dir = false -- true is left, false is right
jumps = 0
on_ground = true
-- functions
function _update()
    dy += gravity

    if btn(k_left) then
        dx = dx-speed
        dir = true
    end
    if btn(k_right) then
        dx = dx+speed
        dir = false
    end
    if btnp(k_up) and (on_ground or jumps < max_jumps) then
        on_ground = false
        -- play sfx
        jumps += 1
        dy = dy - jump_ht
    end
    if on_ground then
        jumps = 0
        dx = dx * friction
    end
    if collision(x+dx,y,7,7) then
        dx = 0
    end
    if collision(x,y+dy,7,7) then
        if dy > 0 then
            on_ground = true
        end
        dy = 0
    end

    x = x + dx
    y = y + dy
end

function _draw()
    cls()
    map(room.x, room.y, room.x*16, room.y*16, 16, 16)
    spr(16, x, y, 1, 1, dir)
end

function collision(x,y,w,h)
    collide = false
    for w=x,x+w,w do
        if (fget(mget(w/8, y/8))>0) or (fget(mget(w/8,(y+h)/8))>0) then
        collide = true
        end
        -- if this is the tutorial room,
        -- the edges of the screen have collision, too
    end
    return collide
end

function start_game()
end

function tutorial()
end

function next_room()
end

__gfx__
00000000ccccc7cc77777777cccc7777cccccccc777ccccc77777777000000000000000000000000000000000000000000000000000000000000000000000000
00000000cccccc7c77777777ccccc777cccccccc77cccccc77ccccc7000000000000000000000000000000000000000000000000000000000000000000000000
00700700cccccccc77ccccc7cccccc77ccccc7cc77ccc7cc7cccccc7000000000000000000000000000000000000000000000000000000000000000000000000
00077000ccc7cccc7cccccccc7cccc77cccc7ccc77cccccc7ccc7cc7000000000000000000000000000000000000000000000000000000000000000000000000
00077000cccc7ccccccccccccccccc777ccccccc77cccc7c7cccc7c7000000000000000000000000000000000000000000000000000000000000000000000000
00700700cccccccccccccccc7c7ccc7777ccccc777cccccc7cccccc7000000000000000000000000000000000000000000000000000000000000000000000000
00000000cc7ccccccc7ccccccccccc7777777777777ccccc77ccccc7000000000000000000000000000000000000000000000000000000000000000000000000
00000000ccc7cccccccccc7ccccc7777777777777777cccc77777777000000000000000000000000000000000000000000000000000000000000000000000000
06666660777777770000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
06f66f60777777770000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
001f1f00777777770000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
055ff550777777770000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
05666650777777770000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
006dd600777777770000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00066000777777770000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00055000777777770000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
__gff__
0001010101010100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
__map__
0000000000000000000000000000000600000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000600000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000600000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000600000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0200000000000000000000000000000600000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0300000000000000000000000000000600000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0300000000000000000000000000000600000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0102000000000000000000000000000600000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0103000000000000000000000000000600000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0103000000000000000000000000000600000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0103000000000000000000000000000600000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0103000000000000000000000000000600000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0101020202020202020202020202020200000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0101010101010101010101010101010100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
